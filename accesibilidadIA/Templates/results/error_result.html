{% extends 'base.html' %}

{% block title %}Resultados > Mi Aplicación > Error{% endblock %}

{% block head %}
    {{ super }}
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
{% endblock %}

{% block header %}
<div class="title-container">
    <h1>Resultados</h1>
</div>
{% endblock %}

{% block content %}
    <div class="container mt-5">
        <h2 class="page-subtitle my-4">Resultados > Mi Aplicación > Error</h2>
        <div class="card border mb-3 p-3">
            <!-- Cabecera del Modal -->
            <div class="card-header">
                <h4 class="modal-title">Corrección de Código</h4>
            </div>

            <!-- Cuerpo del Modal -->
            <div class="card-body">
                <h5>Código Original:</h5>
                <div class="code-container mb-3 p-3 bg-light border rounded">
                    <code>{{original_code}}</code>
                </div>

                <h5>Solución Propuesta:</h5>
                <div class="code-container mb-3 p-3 bg-light border rounded">
                    <code>{{fixed_code}}</code>
                </div>

                <h5>Descripción del error:</h5>
                <div class="code-container mb-3 p-3 bg-light border rounded">
                    <code>{{detected_error}}</code>
                </div>
            </div>

            <!-- Pie de página del Modal -->
            <div class="card-footer d-flex justify-content-end">
                <button type="button" class="btn btn-success me-2" onclick="updateHtml('{{analysis_id}}', '{{ error_name }}')" id="acceptCorrection">
                    Aceptar
                </button>
                <button type="button" class="btn btn-danger" onclick="backToResults('{{analysis_id}}', '{{ error_name }}')" id="rejectCorrection">
                    Rechazar
                </button>
            </div>
        </div>
    </div>

    <script>
        function backToResults(analysis_id, error_name) {
            if (document.referrer) {
                window.history.back();
            } else {
                window.location.href = `/results`;
            }
        }

        function updateHtml(analysis_id, error_name) {
            window.location.href = `/analizador/update_html/${analysis_id}/${error_name}`;
        }
    </script>
{% endblock %}